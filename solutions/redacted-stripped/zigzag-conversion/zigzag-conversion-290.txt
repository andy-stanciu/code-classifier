class Solution {

    public String convert(String s, int numRows) {
        if (s.length() == 1 || numRows == 1) {
            return s;
        }
        StringBuilder result = new StringBuilder();
        int firstRow = 1 + 2 * (numRows - 2);
        int firstPartNextRow = firstRow - 2;
        int secondPartNextRow = firstRow - ((numRows - 2) * 2);
        boolean isFirstTurn = true;
        for (int i = 0; i < numRows; ++i) {
            int it = i;
            if (i == 0 || i == numRows - 1) {
                while (it < s.length()) {
                    result.append(s.charAt(it));
                    it += firstRow + 1;
                }
            } else {
                while (it < s.length()) {
                    result.append(s.charAt(it));
                    if (isFirstTurn) {
                        it += firstPartNextRow + 1;
                        isFirstTurn = false;
                    } else {
                        it += secondPartNextRow + 1;
                        isFirstTurn = true;
                    }
                }
                isFirstTurn = true;
                firstPartNextRow -= 2;
                secondPartNextRow += 2;
            }
        }
        return result.toString();
    }
}
