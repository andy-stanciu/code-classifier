class Solution {

    public String convert(String s, int numRows) {
        if (numRows == 1) {
            return s;
        }
        StringBuilder output = new StringBuilder();
        int dcc = numRows - 2;
        int gc = numRows + dcc;
        boolean hasDiagonalChars = false;
        int diagCharDelta = -1;
        for (int i = 0; i < numRows; i++) {
            int index = i;
            if (i % numRows == 0 || (i + 1) % numRows == 0) {
                diagCharDelta = -1;
                hasDiagonalChars = false;
            } else {
                diagCharDelta = hasDiagonalChars ? diagCharDelta - 2 : dcc * 2;
                hasDiagonalChars = true;
            }
            while (index < s.length()) {
                output.append(s.charAt(index));
                if (hasDiagonalChars && (index + diagCharDelta) < s.length()) {
                    output.append(s.charAt(index + diagCharDelta));
                }
                index += gc;
            }
        }
        return output.toString();
    }
}
