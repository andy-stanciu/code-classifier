class Solution {

    public int method1(TreeNode root) {
        TreeNode res = new TreeNode(Integer.MIN_VALUE);
        method2(root, res);
        if (res.val < root.val) {
            return root.val;
        }
        return res.val;
    }

    private int method2(TreeNode root, TreeNode res) {
        if (root == null)
            return 0;
        int lh = Math.max(0, method2(root.left, res));
        int rh = Math.max(0, method2(root.right, res));
        res.val = Math.max(res.val, Math.max((lh + rh + root.val), Math.max(root.val, Math.max((lh + root.val), (rh + root.val)))));
        return (root.val + Math.max(lh, rh));
    }
}
