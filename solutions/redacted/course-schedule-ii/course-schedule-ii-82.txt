class Solution {

    public int[] findOrder(int param1, int[][] prerequisites) {
        // orginize the prerequisites into a array of lists
        // indexs of array represents the course number
        // elements are the list of prerequisites of the course
        List<Integer>[] orgPres = organizePrerequisites(param1, prerequisites);
        // dfs search for prerequisites of every courses
        List<Integer> var1 = new ArrayList<>();
        boolean[] var2 = new boolean[param1];
        for (int i = 0; i < param1; i++) {
            // if this course can not be taken
            // then it is impossible to finish all courses
            if (!dfs(i, orgPres, new boolean[param1], var2, var1))
                return new int[0];
        }
        // convert the list of schedule into an array
        int[] res = new int[param1];
        for (int i = 0; i < param1; i++) {
            res[i] = var1.get(i);
        }
        return res;
    }

    // dfs helper function to dfs search for prerequisites of a course
    // return true if this course is taken
    private boolean dfs(int param2, List<Integer>[] orgPres, boolean[] visited, boolean[] var2, List<Integer> var1) {
        // if the course is already taken, return
        if (var2[param2])
            return true;
        // if the course has no prerequisite, this course can be taken
        // add this course to the schedule and mark this course as taken
        if (orgPres[param2] == null || var2[param2]) {
            var2[param2] = true;
            var1.add(param2);
            return true;
        }
        // if the course is already visited during dfs search for the prerequisites
        // it means that this course is the prerequisite of itself
        // so this course can not be taken
        if (visited[param2])
            return false;
        // for all prerequisites of this course
        // chech if they can be taken by dfs search their prerequisites
        visited[param2] = true;
        for (int pre : orgPres[param2]) {
            // if the prerequiste can not be taken
            // then this course can not be taken
            if (!dfs(pre, orgPres, visited, var2, var1))
                return false;
        }
        // all prereqiusites are already taken
        // add this course to the schedule and mark this course as taken
        var2[param2] = true;
        var1.add(param2);
        return true;
    }

    // helper function to organize prerequisite courses
    private List[] organizePrerequisites(int n, int[][] prerequisites) {
        List<Integer>[] res = new List[n];
        for (int[] p : prerequisites) {
            if (res[p[0]] == null)
                res[p[0]] = new ArrayList<>();
            res[p[0]].add(p[1]);
        }
        return res;
    }
}
