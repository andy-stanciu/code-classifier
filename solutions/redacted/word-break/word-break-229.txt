class Solution {

    public boolean method1(String s, List<String> param1) {
        return wb(s, new HashSet<>(param1), new HashMap<>(), 0);
    }

    private boolean wb(String s, Set<String> dict, Map<Integer, Boolean> cache, int curr) {
        if ("".equals(s))
            return true;
        if (cache.containsKey(curr))
            return cache.get(curr);
        for (int i = 0; i < s.length(); i++) {
            if (dict.contains(s.substring(0, i + 1))) {
                String rest = s.substring(i + 1);
                if (dict.contains(rest) || wb(rest, dict, cache, i + 1)) {
                    cache.put(curr, true);
                    return true;
                } else
                    //WORKS_HERE
                    cache.put(curr, false);
            }
        }
        /**
         *            Note putting false in cache here,
         *            fails some test cases. And if I move it
         *            to the else case above (marked `WORKS_HERE`),
         *            the solution works for all cases. Ponder why.
         */
        //cache.put(curr, false);
        return false;
    }
}
