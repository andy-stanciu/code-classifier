class Solution {

    public String convert(String s, int numRows) {
        int len = s.length();
        if (numRows == 1 || numRows >= len) {
            return s;
        }
        int cycleLen = numRows + numRows - 2;
        int numCycles = len / cycleLen + 1;
        int cols = numCycles * (numRows - 1);
        StringBuilder sb = new StringBuilder();
        for (int row = 0; row < numRows; row++) {
            for (int cycle = 0; cycle < numCycles; cycle++) {
                int first = cycle * cycleLen + row;
                int second = (cycle + 1) * cycleLen - row;
                if (first < len) {
                    sb.append(s.charAt(first));
                }
                if (row != 0 && row != numRows - 1 && second < len) {
                    sb.append(s.charAt(second));
                }
            }
        }
        return sb.toString();
    }
}
