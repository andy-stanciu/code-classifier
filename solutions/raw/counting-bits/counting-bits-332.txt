class Solution {

    public int[] countBits(int n) {
        int[] ans = new int[(n + 1)];
        if (n == 0) {
            return ans;
        }
        ans[0] = 0;
        ans[1] = 1;
        int twoPowerIndex = 2;
        while (twoPowerIndex <= n) {
            ans[twoPowerIndex] = 1;
            twoPowerIndex *= 2;
        }
        twoPowerIndex = 2;
        int generalIndex = twoPowerIndex + 1;
        while (generalIndex <= n) {
            ans[generalIndex] = ans[twoPowerIndex] + ans[generalIndex - twoPowerIndex];
            generalIndex++;
            if (generalIndex == (twoPowerIndex * 2)) {
                twoPowerIndex *= 2;
                generalIndex = twoPowerIndex + 1;
            }
        }
        return ans;
    }
}
