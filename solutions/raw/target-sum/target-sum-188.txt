class Solution {

    public int findTargetSumWays(int[] nums, int target) {
        int n = nums.length;
        if (n == 1 && (nums[0] == target || -1 * nums[0] == target))
            return 1;
        else if (n == 1)
            return 0;
        int sum = 0;
        for (int num : nums) {
            sum += num;
        }
        if (target > sum || target < -sum) {
            return 0;
        }
        // Define the range of dp array based on the potential range of target
        int range = 2 * sum + 1;
        int[][] dp = new int[n][range];
        for (int[] row : dp) Arrays.fill(row, Integer.MIN_VALUE);
        // Shift the target to positive range
        return f(0, 0, target, n, nums, dp, sum);
    }

    public int f(int index, int sum, int target, int n, int[] arr, int[][] dp, int arrsum) {
        if (index == n - 1) {
            if (sum + arr[n - 1] == target || sum - arr[n - 1] == target) {
                if (arr[n - 1] == 0)
                    return 2;
                else
                    return 1;
            } else
                return 0;
        }
        if (dp[index][sum + arrsum] != Integer.MIN_VALUE)
            return dp[index][sum + arrsum];
        int plusway = f(index + 1, sum + arr[index], target, n, arr, dp, arrsum);
        int minusway = f(index + 1, sum - arr[index], target, n, arr, dp, arrsum);
        return dp[index][sum + arrsum] = plusway + minusway;
    }
}
