class Solution {

    List<List<Integer>> ans = new ArrayList<>();

    public List<List<Integer>> combinationSum2(int[] arr, int target) {
        Arrays.sort(arr);
        List<Integer> al = new ArrayList<>();
        fun(arr, 0, 0, al, target);
        //array,start,sum,al,target;
        return ans;
    }

    boolean fun(int[] arr, int start, int sum, List<Integer> al, int target) {
        if (sum > target)
            return true;
        if (sum == target) {
            ans.add(new ArrayList<>(al));
            return true;
        }
        for (int i = start; i < arr.length; i++) {
            al.add(arr[i]);
            if (fun(arr, i + 1, sum + arr[i], al, target)) {
                al.remove(al.size() - 1);
                return false;
            }
            al.remove(al.size() - 1);
            while (i + 1 < arr.length && arr[i] == arr[i + 1]) i++;
        }
        return false;
    }
}
