class Solution {

    public void gameOfLife(int[][] board) {
        int[] livingMap = { 10, 1, 20 };
        int[] deathMap = { 0, 30 };
        for (int i = 0; i < board.length; i++) {
            for (int j = 0; j < board[i].length; j++) {
                int countDeath = countNeighbors(board, i, j, deathMap);
                int countLiving = countNeighbors(board, i, j, livingMap);
                if (board[i][j] == 1 || board[i][j] == 10) {
                    // live
                    if (countLiving < 2) {
                        // die
                        board[i][j] = 20;
                    } else if (countLiving <= 3) {
                        // live
                        board[i][j] = 10;
                    } else if (countLiving > 3) {
                        // die
                        board[i][j] = 20;
                    }
                } else if (board[i][j] == 0 || board[i][j] == 20) {
                    // dead
                    if (countLiving == 3) {
                        // live
                        board[i][j] = 30;
                    }
                }
            }
        }
        for (int i = 0; i < board.length; i++) {
            for (int j = 0; j < board[i].length; j++) {
                if (board[i][j] == 10 || board[i][j] == 30) {
                    board[i][j] = 1;
                } else if (board[i][j] == 20) {
                    board[i][j] = 0;
                }
            }
        }
    }

    private int countNeighbors(int[][] board, int x, int y, int[] include) {
        int[] dx = { -1, -1, -1, 0, 1, 1, 1, 0 };
        int[] dy = { -1, 0, 1, 1, 1, 0, -1, -1 };
        int count = 0;
        for (int i = 0; i < dx.length; i++) {
            if (0 <= x + dx[i] && x + dx[i] < board.length && 0 <= y + dy[i] && y + dy[i] < board[0].length) {
                for (int typ : include) {
                    if (board[x + dx[i]][y + dy[i]] == typ) {
                        count++;
                    }
                }
            }
        }
        return count;
    }
}
