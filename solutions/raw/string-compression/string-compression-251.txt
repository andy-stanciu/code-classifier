class Solution {

    public int compress(char[] chars) {
        int n = chars.length;
        int write = 0;
        int anchor = 0;
        for (int read = 0; read <= n; read++) {
            if (read == n || chars[read] != chars[anchor]) {
                // Write the character
                chars[write++] = chars[anchor];
                if (read - anchor > 1) {
                    String count = String.valueOf(read - anchor);
                    for (char c : count.toCharArray()) {
                        // Write the count as characters
                        chars[write++] = c;
                    }
                }
                // Move anchor to the next different character
                anchor = read;
            }
        }
        return write;
    }
}
