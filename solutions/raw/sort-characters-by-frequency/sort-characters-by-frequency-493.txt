class Solution {

    public String frequencySort(String s) {
        HashMap<Character, Integer> map = new HashMap<>();
        for (int i = 0; i < s.length(); i++) {
            map.put(s.charAt(i), map.getOrDefault(s.charAt(i), 0) + 1);
        }
        StringBuilder str = new StringBuilder();
        while (!map.isEmpty()) {
            int maxValueInMap = Collections.max(map.values());
            for (Iterator<Map.Entry<Character, Integer>> iterator = map.entrySet().iterator(); iterator.hasNext(); ) {
                Map.Entry<Character, Integer> entry = iterator.next();
                if (entry.getValue() == maxValueInMap) {
                    int i = 0;
                    while (i < maxValueInMap) {
                        str.append(entry.getKey());
                        entry.setValue(entry.getValue() - 1);
                        i++;
                    }
                    if (entry.getValue() == 0) {
                        iterator.remove();
                    }
                }
            }
        }
        return str.toString();
    }
}
