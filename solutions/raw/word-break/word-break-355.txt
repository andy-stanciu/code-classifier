class Solution {

    public boolean wordBreak(String s, List<String> wordDict) {
        List<String> partialSolutions = new ArrayList<>();
        HashSet<String> tried = new HashSet<>();
        partialSolutions.add("");
        return search(s, partialSolutions, tried, wordDict);
    }

    private boolean search(String original, List<String> partialSolutions, Set<String> tried, List<String> dict) {
        if (partialSolutions.size() > 0) {
            //Get the partial solution
            String partial = partialSolutions.get(0);
            partialSolutions.remove(0);
            if (!tried.contains(partial)) {
                tried.add(partial);
                boolean solutionFound = false;
                for (String word : dict) {
                    if (original.equals(partial + word)) {
                        solutionFound = true;
                        break;
                    } else if (original.startsWith(partial + word)) {
                        partialSolutions.add(partial + word);
                        solutionFound = search(original, partialSolutions, tried, dict);
                        if (solutionFound) {
                            break;
                        }
                    }
                }
                if (solutionFound) {
                    return true;
                }
            }
        }
        return false;
    }
}
