class Solution {

    public boolean wordBreakImpl(String s, HashSet<String> set) {
        boolean[] dp = new boolean[s.length()];
        int l = 0;
        while (l < s.length()) {
            int k = l - 1;
            if (set.contains(s.charAt(l)) || set.contains(s.substring(0, l + 1))) {
                dp[l] = true;
            } else {
                while (k >= 0 && !(dp[k] && set.contains(s.substring(k + 1, l + 1)))) {
                    k--;
                }
                if (k >= 0 && dp[k] && set.contains(s.substring(k + 1, l + 1))) {
                    dp[l] = true;
                }
            }
            l++;
        }
        return dp[s.length() - 1];
    }

    public boolean wordBreak(String s, List<String> wordDict) {
        HashSet<String> set = new HashSet<>(wordDict);
        return wordBreakImpl(s, set);
    }
}
