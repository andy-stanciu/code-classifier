class Solution {

    public TreeNode deleteNode(TreeNode root, int key) {
        if (root == null)
            return root;
        if (root.val == key)
            return delete(root.left, root.right);
        find(root.left, root, true, key);
        find(root.right, root, false, key);
        return root;
    }

    private TreeNode delete(TreeNode left, TreeNode right) {
        if (left == null && right == null)
            return null;
        if (left == null)
            return right;
        if (right == null)
            return left;
        if (right.left == null)
            right.left = delete(left, right.left);
        else
            delete(left, right.left);
        return right;
    }

    private void find(TreeNode root, TreeNode prev, boolean isLeft, int val) {
        if (root == null)
            return;
        if (root.val == val) {
            if (isLeft)
                prev.left = delete(root.left, root.right);
            else
                prev.right = delete(root.left, root.right);
            root.left = null;
            root.right = null;
        }
        if (val < root.val)
            find(root.left, root, true, val);
        else
            find(root.right, root, false, val);
    }
}
