class Solution {

    public int uniquePathsWithObstacles(int[][] obstacleGrid) {
        if (obstacleGrid[0][0] == 1 || obstacleGrid[obstacleGrid.length - 1][obstacleGrid[0].length - 1] == 1)
            return 0;
        int[][] dp = new int[obstacleGrid.length][obstacleGrid[0].length];
        for (int[] row : dp) Arrays.fill(row, -1);
        return uniquePathsWithObstacles(obstacleGrid, dp, 0, 0);
    }

    int uniquePathsWithObstacles(int[][] obstacleGrid, int[][] dp, int row, int col) {
        if (dp[row][col] != -1)
            return dp[row][col];
        int rows = obstacleGrid.length;
        int cols = obstacleGrid[0].length;
        if (row == rows - 1 && col == cols - 1)
            return 1;
        int paths = 0;
        if (col + 1 < cols && obstacleGrid[row][col + 1] != 1) {
            dp[row][col + 1] = uniquePathsWithObstacles(obstacleGrid, dp, row, col + 1);
            paths += dp[row][col + 1];
        }
        if (row + 1 < rows && obstacleGrid[row + 1][col] != 1) {
            dp[row + 1][col] = uniquePathsWithObstacles(obstacleGrid, dp, row + 1, col);
            paths += dp[row + 1][col];
        }
        return dp[row][col] = paths;
    }
}
