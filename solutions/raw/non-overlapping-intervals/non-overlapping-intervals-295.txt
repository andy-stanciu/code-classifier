class Solution {

    public int eraseOverlapIntervals(int[][] intervals) {
        Arrays.sort(intervals, (interval1, interval2) -> {
            int subtractStart = interval1[1] - interval2[1];
            if (subtractStart != 0)
                return subtractStart;
            else
                return interval1[0] - interval2[0];
        });
        // how many intervals max can keep end at i th interval
        int[] dp = new int[intervals.length];
        Arrays.fill(dp, 1);
        int max = 1;
        for (int i = 1; i < intervals.length; i++) {
            int curStart = intervals[i][0];
            int curEnd = intervals[i][1];
            for (int j = i - 1; j >= 0; j--) {
                int preEnd = intervals[j][1];
                if (preEnd <= curStart) {
                    int count = dp[j] + 1;
                    if (count > dp[i]) {
                        dp[i] = count;
                        max = Math.max(max, dp[i]);
                    }
                }
                if (dp[i] > j)
                    break;
            }
        }
        return intervals.length - max;
    }
}
