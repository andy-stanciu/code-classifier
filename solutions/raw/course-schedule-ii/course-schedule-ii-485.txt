class Solution {

    public int[] findOrder(int numCourses, int[][] prerequisites) {
        List<Integer> result = new ArrayList<>();
        // indegree is an array representing the indegree of all nodes
        int[] indegree = new int[numCourses];
        // we construct an adjacency list of all courses: prereqs
        Map<Integer, List<Integer>> map = new HashMap<>();
        for (int[] prereq : prerequisites) {
            int course = prereq[0];
            int prereqCourse = prereq[1];
            map.computeIfAbsent(course, val -> new ArrayList<Integer>()).add(prereqCourse);
            indegree[course]++;
        }
        Queue<Integer> queue = new LinkedList<>();
        int zeroCount = 0;
        for (int i = 0; i < indegree.length; i++) {
            if (indegree[i] == 0) {
                zeroCount++;
            }
        }
        // if we don\'t have any courses with an indegree of 0 we cannot start our scheduling process
        if (zeroCount == 0) {
            return new int[0];
        }
        // we start our process off with any course that has an indegree of 0, meaning this course has no prereq
        for (int i = 0; i < indegree.length; i++) {
            if (indegree[i] == 0) {
                queue.add(i);
            }
        }
        while (!queue.isEmpty()) {
            int course = queue.remove();
            result.add(course);
            // we take our current course and remove it from the list of prereqs of all other courses.
            for (Integer key : map.keySet()) {
                List<Integer> list = map.get(key);
                if (list.contains(course)) {
                    list.remove(Integer.valueOf(course));
                    // for all courses that had the current course as a prereq we reduce their indegree by 1.
                    indegree[key]--;
                    // we enqueue the next key with an indegree of 0.
                    if (indegree[key] == 0) {
                        queue.add(key);
                    }
                }
            }
        }
        // if we still have any courses with an indegree of 0 then we have not properly scheduled all courses
        for (int i = 0; i < indegree.length; i++) {
            if (indegree[i] != 0) {
                return new int[0];
            }
        }
        return result.stream().mapToInt(Integer::intValue).toArray();
    }
}
