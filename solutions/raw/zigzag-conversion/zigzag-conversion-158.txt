class Solution {

    public String convert(String s, int numRows) {
        // Special case: no zigzag when numRows is 1
        if (numRows == 1)
            return s;
        // Use StringBuilder for efficient appending
        StringBuilder res = new StringBuilder();
        int n = s.length();
        for (int row = 0; row < numRows; row++) {
            int step1 = 2 * (numRows - 1 - row);
            int step2 = 2 * row;
            int pos = row;
            while (pos < n) {
                if (step1 > 0) {
                    // First jump
                    res.append(s.charAt(pos));
                    pos += step1;
                }
                // Prevent out of bounds
                if (pos >= n)
                    break;
                if (step2 > 0) {
                    // Second jump
                    res.append(s.charAt(pos));
                    pos += step2;
                }
            }
        }
        return res.toString();
    }
}
