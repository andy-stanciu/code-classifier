class Solution {

    public String convert(String s, int numRows) {
        //Nothing to do if only a single row
        if (numRows == 1) {
            return s;
        }
        StringBuilder output = new StringBuilder();
        //Diagonal char count
        int dcc = numRows - 2;
        //Group count
        int gc = numRows + dcc;
        //Flag to check if we will add diagonal chars for this row
        boolean hasDiagonalChars = false;
        //Number to add to current index to get the index of diagonal char
        int diagCharDelta = -1;
        for (int i = 0; i < numRows; i++) {
            int index = i;
            //If first or last row, no diagonal characters
            if (i % numRows == 0 || (i + 1) % numRows == 0) {
                diagCharDelta = -1;
                hasDiagonalChars = false;
            } else {
                //If this is the first time we are adding diagonal chars (as in Row #2),
                //we start with diagCharDelta = dcc * 2, otherwise we know diagCharDelta is already set
                //and we just reduce it by 2.
                diagCharDelta = hasDiagonalChars ? diagCharDelta - 2 : dcc * 2;
                hasDiagonalChars = true;
            }
            while (index < s.length()) {
                output.append(s.charAt(index));
                if (hasDiagonalChars && (index + diagCharDelta) < s.length()) {
                    output.append(s.charAt(index + diagCharDelta));
                }
                index += gc;
            }
        }
        return output.toString();
    }
}
