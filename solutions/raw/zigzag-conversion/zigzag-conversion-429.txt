class Solution {

    public String convert(String s, int numRows) {
        if (numRows == 1)
            return s;
        final int len = s.length();
        final int width = len / numRows;
        final int zagLen = numRows - 2;
        final int zigZagLen = numRows + zagLen;
        final char[] results = new char[len];
        int resIdx = 0;
        for (int i = 0; i < len; i += zigZagLen) results[resIdx++] = s.charAt(i);
        for (int rn = 1; rn < numRows - 1; ++rn) {
            boolean flipFlop = false;
            for (int i = rn; i < len; i += 2 * (flipFlop ? rn : numRows - 1 - rn), flipFlop = !flipFlop) {
                results[resIdx++] = s.charAt(i);
            }
        }
        for (int i = numRows - 1; i < len; i += zigZagLen) results[resIdx++] = s.charAt(i);
        return String.valueOf(results);
    }
}
