class Solution {

    public boolean canFinish(int numCourses, int[][] prerequisites) {
        ArrayList<Integer>[] graph = new ArrayList[numCourses];
        boolean[] visited = new boolean[numCourses];
        boolean[] nodes = new boolean[numCourses];
        for (int i = 0; i < numCourses; i++) {
            graph[i] = new ArrayList<>();
        }
        for (int[] arr : prerequisites) {
            graph[arr[0]].add(arr[1]);
        }
        for (int i = 0; i < numCourses; i++) {
            if (!visited[i] && isCyclic(graph, visited, nodes, i)) {
                return false;
            }
            // if cycle is not found than that course is compeleted means visited true
            visited[i] = true;
        }
        return true;
    }

    private boolean isCyclic(ArrayList<Integer>[] graph, boolean[] visited, boolean[] nodes, int src) {
        // if courese comes twice than it is cycle than return true
        if (nodes[src]) {
            return true;
        }
        // if course is already completed (already visited )than return false
        if (visited[src]) {
            return false;
        }
        for (int i = 0; i < graph[src].size(); i++) {
            nodes[src] = true;
            if (isCyclic(graph, visited, nodes, graph[src].get(i))) {
                return true;
            }
            nodes[src] = false;
        }
        return false;
    }
}
